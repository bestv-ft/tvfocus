var TVFocus=function(n){var i={};function r(t){if(i[t])return i[t].exports;var e=i[t]={i:t,l:!1,exports:{}};return n[t].call(e.exports,e,e.exports,r),e.l=!0,e.exports}return r.m=n,r.c=i,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=5)}([function(t,e){var l={},o=["#e61717","#3082d6","#fad538"],a=0;t.exports={OpenDebug:0,moveType:1,calcSpace:function(t){if(undefined===t.$layout){var e,n=undefined!==t.scrollY?t.$scroll:t.$ele,i=n.getBoundingClientRect(),r=parseInt(i.left),s=parseInt(i.top);return t.parent?(t.parent.scrollX?t.left=r-t.parent.x-t.parent.scrollX:t.left=r-t.parent.x,t.parent.scrollY?t.top=s-t.parent.y-t.parent.scrollY:t.top=s-t.parent.y):(t.left=r,t.top=s),t.width=parseInt(i.width),t.height=parseInt(i.height),t.parent&&undefined!==t.parent.$calcSize&&(o=t.parent.$calcSize,undefined===o.x?o.y=t.top:o.y!=t.top?(undefined===o.g&&(e=getComputedStyle(t.$ele,null),o.g=t.left+(parseInt(e.marginRight)||0)),t.left=o.x+o.g,t.top=o.y):undefined===o.g&&(o.g=t.left-o.x),o.x=t.left+t.width),t.x=r,void(t.y=s)}var o,a=t.$layout;t.left=a.left||0,t.top=a.top||0,undefined===a.width||undefined===a.height?l[t.name]?(t.width=l[t.name].width,t.height=l[t.name].height):(e=getComputedStyle(t.$ele,null),undefined===a.width?t.width=parseInt(e.width):t.width=a.width,undefined===a.height?t.height=parseInt(e.height):t.height=a.height,l[t.name]={width:t.width,height:t.height}):(t.width=a.width,t.height=a.height),t.parent?(t.x=t.left+t.parent.x,t.y=t.top+t.parent.y,undefined!==t.parent.$calcSize&&(o=t.parent.$calcSize,undefined===o.x&&(o.x=0,o.g=2*t.left),t.left>o.x&&(o.x=t.left),o.x=o.x+t.width,o.g=t.width)):(t.x=t.left,t.y=t.top)},showBorder:function(t){var e,n,i,r,s;this.OpenDebug&&(o.length<=++a&&(a=0),e=getComputedStyle(t.$ele,null).position,n=o[a],i=document.createElement("div"),s=9*(r=1===this.OpenDebug?t.name+" "+t.width+"*"+t.height:t.name+" "+t.left+","+t.top).length,"relative"!=e&&"absolute"!=e&&(t.$ele.style.position="relative"),t.$ele.style.boxSizing="border-box",t.$ele.style.border="2px solid "+n,i.style.position="absolute",i.style.top="0px",i.style.fontSize="14px",i.style.textAlign="center",i.style.lineHeight="initial",i.style.left=Math.floor((t.width-s)/2)+"px",i.style.width=s+"px",i.style.height="20px",i.style.color="#ffffff",i.style.backgroundColor=n,i.innerHTML=r,t.$ele.appendChild(i))},buildPostStypeString:function(t,e){return 1==this.moveType?"-webkit-transform:translate3d('+("+t+"||0)+'px,'+("+e+"||0)+'px,0px)":"left:'+("+t+"||0)+'px;top:'+("+e+"||0)+'px"},setScrollStyle:function(t,e){return 1==this.moveType?t.$scroll.style.webkitTransform="translate3d("+(t.scrollX||0)+"px,"+(t.scrollY||0)+"px,0px)":t.$scroll.style.left="x"==e?t.scrollX+"px":t.scrollY+"px"}}},function(t,e){function r(t,e,n){var i="";if("object"==typeof t){if("TVFocus "===t.message.substr(0,8))return t;i=t.message}switch(n=n||r.ERROR_RUN,undefined===n&&(n=r.ERROR_CREATE),e&&(i+=" in this template:\n ------------------\x3e\n",i+=e,i+="\n<------------------"),n){case r.ERROR_CREATE:i="TVFocus CreateNode Error:\n"+i;break;case r.ERROR_COMPILE:i="TVFocus Compile Error:\n"+i;break;case r.ERROR_RUN:i="TVFocus Render Error:\n"+i;break;default:i="TVFocus System Error:\n"+i}return new Error(i)}r.ERROR_CREATE=1,r.ERROR_COMPILE=2,r.ERROR_RUN=3,r.ERROR_TYPE=4,t.exports=r},function(t,e){var n=function(t){var e=[],n={},i=t.substr(0,1);switch("."==i?(n.type="class",n.value=t.substr(1)):"#"==i?(n.type="id",n.value=t.substr(1)):"@"==i?(n.type="name",n.value=t.substr(1)):"[name="==t.substr(0,6)?(n.type="name",n.value=t.substr(6).replace(/['"\]]/g,"")):/[a-zA-Z]/.test(i)&&(n.type="tag",n.value=t),n.type){case"class":e=this.getElementsByClassName(n.value);break;case"id":e=[document.getElementById(n.value)];break;case"name":e=document.getElementsByName(n.value);break;case"tag":e=this.getElementsByTagName(n.value)}return e};Function.prototype.bind||(Function.prototype.bind=function(t){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var e=Array.prototype.slice.call(arguments,1),n=e.length,i=this,r=function(){},s=function(){return e.length=n,e.push.apply(e,arguments),i.apply(r.prototype.isPrototypeOf(this)?this:t,e)};return this.prototype&&(r.prototype=this.prototype),s.prototype=new r,s}),Object.freeze||(Object.freeze=function(t){return t._freezeID=Math.random(),t},Object.isFrozen=function(t){return!!t.BJF_freezeID}),String.prototype.trim||(String.prototype.trim=function(t){return undefined===t?this.replace(/(^\s*)|(\s*$)/g,""):this.replace(new RegExp("^\\"+t+"+|\\"+t+"+$","g"),"")}),Array.prototype.forEach||(Array.prototype.forEach=function(t,e){var n,i;if(null===this)throw new TypeError("this is null or not defined");var r,s=Object(this),o=s.length>>>0;if("function"!=typeof t)throw new TypeError(t+" is not a function");for(1<arguments.length&&(n=e),i=0;i<o;){i in s&&(r=s[i],t.call(n,r,i,s)),i++}}),Array.prototype.map||(Array.prototype.map=function(t,e){var n,i,r;if(null==this)throw new TypeError("this is null or not defined");var s,o,a=Object(this),l=a.length>>>0;if("function"!=typeof t)throw new TypeError(t+" is not a function");for(1<arguments.length&&(n=e),1<arguments.length&&(n=e),i=new Array(l),r=0;r<l;){r in a&&(s=a[r],o=t.call(n,s,r,a),i[r]=o),r++}return i}),"object"!=typeof document||document.querySelector||(document.querySelector=function(t){var e=n.call(document,t);return 0<e.length?e[0]:null},document.querySelectorAll=function(t){return n.call(document,t)}),t.exports={querySelectorAll:function(t,e){return e.querySelectorAll?e.querySelectorAll(t):n.call(e,t)},querySelector:function(t,e){return e.querySelector?e.querySelector(t):n.call(e,t)[0]||null}}},function(t,e,n){var i=n(0),r=n(4),s={},o={},a={},l={},u={},h={},c=n(2);function p(t){this.defaultPrevented=!1,this.propagationStopped=!1,this.data=t||{},this.delay=0}function d(t){if(this.disabled=t.disabled||0,undefined!==t.cache&&(this.cacheID=t.cache),this.data={},this.tags=[],this.focus_data=[],this.$data=t.data||{},this.name=t.name||"root",this.$ele=null,this.$render=t.render,this.scrollY=t.scrollY,this.scrollX=t.scrollX,undefined!==t.layout&&(this.$layout=t.layout),undefined!==t.ext_data)for(var e in t.ext_data)this.$data[e]=t.ext_data[e];this.select=0,this.selectDelay=0,this.status=0,this.fingerprint=r(),o[this.fingerprint]=this,t.id&&this.setId(t.id),this.dispatch("created",this.$data),t.ele&&(t.ele.innerHTML=this.render(),this.mount(t.ele))}p.prototype.preventDefault=function(){this.defaultPrevented=!0},p.prototype.sleep=function(t){this.delay=t},p.prototype.stopPropagation=function(){this.propagationStopped=!0},d.prototype.render=function(){return undefined!==this.index&&(this.$data.$index=this.index),this.$render.call(this,this.$data)},d.prototype.rerender=function(t){this.children&&(this.children.forEach(function(t){t.destroy()}),this.children,this.children=undefined);var e,n=this.$render.call(this,t);this.$scroll?(this.$scroll.innerHTML=n,undefined!==this.scrollX&&(this.$calcSize={})):this.$ele.innerHTML=n,this.children&&(e=this).children.forEach(function(t){t.mount(c.querySelector("#"+t.fingerprint,e.$ele))}),this.$calcSize&&this.$calcSize.x&&(this.$scroll.style.width=this.$calcSize.x+this.$calcSize.g+"px",this.$calcSize=undefined)},d.prototype.mount=function(t){var e;if(this.$ele=t,undefined===this.scrollY&&undefined===this.scrollX||(this.$scroll=this.$ele.firstElementChild),i.calcSpace(this),undefined!==this.scrollX&&(this.$calcSize={}),this.id||this.setId(),this.children&&(e=this).children.forEach(function(t){t.mount(c.querySelector("#"+t.fingerprint,e.$ele))}),!this.height)throw new Error("Focus "+this.name+" not set height");this.$calcSize&&this.$calcSize.x&&(this.$scroll.style.width=this.$calcSize.x+this.$calcSize.g+"px",this.width=this.$calcSize.x,this.$calcSize=undefined),i.showBorder(this),this.dispatch("mounted",this.$data);for(var n=this.focus_data.length;0<=n;n--)this.$data[this.focus_data[n]]&&(this.data[this.focus_data[n]]=this.$data[this.focus_data[n]]);this.$data=undefined,this.$layout=undefined,this.focus_data=undefined},d.prototype.dispatch=function(t,e){var n,i,r=e instanceof p?e:new p(e);if(!r.propagationStopped){l[this.name]&&l[this.name][t]&&l[this.name][t].call(this,r);for(var s=this.tags.length;0<=s;s--)l["$__"+this.tags[s]]&&l["$__"+this.tags[s]][t]&&l["$__"+this.tags[s]][t].call(this,r);!1===r.defaultPrevented&&l.$&&l.$[t]&&l.$[t].call(this,r)}if(!r.defaultPrevented&&u[t]&&(0<r.delay?(i=this,setTimeout(function(){u[t].call(i,r)},r.delay),r.delay=0):u[t].call(this,r)),"on"==t)this.status=1,this.parent&&this.status!=this.parent.status&&this.parent.dispatch(t,r),this.children||(i=this,setTimeout(function(){1==i.status&&0==i.select&&(i.cacheID&&(a[i.cacheID]&&(a[i.cacheID].select=0,a[i.cacheID].dispatch("unselected",new p)),a[i.cacheID]=i),i.select=1,i.dispatch("selected",new p))},this.selectDelay));else if("blur"==t||"border"==t){if("blur"==t&&(1!=this.select||this.cacheID||(this.dispatch("unselected",new p),this.select=0),this.status=0),!this.parent)return r;if(r.data.new_node&&r.data.new_node.parent)for(n=r.data.new_node.parent;n&&n.fingerprint!==this.parent.fingerprint;)n=n.parent;n||this.parent.dispatch(t,r)}return r},d.prototype.getRect=function(){return{width:this.width,height:this.height,top:this.top+(this.scrollY||0),left:this.left+(this.scrollX||0)}},d.prototype.getPost=function(){var t={top:0,left:0};return this.parent&&(t=this.parent.getPost()),{width:this.width,height:this.height,top:this.top+(this.scrollY||0)+t.top,left:this.left+(this.scrollX||0)+t.left}},d.prototype.markFocusData=function(t){t instanceof Array?this.focus_data=t:this.focus_data.push(t)},d.prototype.onMessage=function(t,e){h[t]||(h[t]={}),h[t][this.id]=e},d.prototype.postMessage=function(t,e,n){if(h[t])if(n)s[n]&&h[t][n]&&h[t][n].call(s[n],{source:this,data:e});else for(var i in h[t])h[t][i].call(s[i],{source:this,data:e})},d.prototype.getEle=function(){return this.$ele},d.prototype.addTag=function(t){-1===this.tags.indexOf(t)&&this.tags.push(t)},d.prototype.addChild=function(t){return this.children||(this.children=[]),t.parent=this,t.index=this.children.length,this.cacheID&&!t.cacheID&&(t.cacheID=this.cacheID),this.children.push(t),t},d.prototype.setScrollX=function(t){return!!this.$scroll&&(this.scrollX=t,i.setScrollStyle(this,"x"))},d.prototype.setScrollY=function(t){return!!this.$scroll&&(this.scrollY=t,i.setScrollStyle(this,"y"))},d.prototype.setSelectedTime=function(t){this.selectDelay=t},d.prototype.getChildByIndex=function(t){return!this.children||t>=this.children.length?null:this.children[t]},d.prototype.setId=function(t){var e;this.id||(t&&!s[t]?this.id=t:(e=this.name,this.parent&&this.parent.id&&(e=this.parent.id+"_"+this.index+"_"+e),this.id=e),s[this.id]=this)},d.prototype.destroy=function(){s[this.id]=null,o[this.fingerprint]=null,this.select&&this.cacheID&&(a[this.cacheID]=null),this.dispatch("destroy")},d.querySelecter=function(t){return"#"==t.substr(0,1)?o[t.substr(1)]||null:s[t]||null},d.addEventListener=function(t,e,n){"#"==t.substr(0,1)&&(t="$__"+t.substr(1)),l[t]||(l[t]={}),l[t][e]=n},d.addDefaultEventListener=function(t,e){u[t]=e},t.exports=d},function(t,e){t.exports=function(){return"fxxxxxxx_xxxx_4xxx_yxxx_xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(16)})}},function(t,e,n){n(2);var r=n(3),i=n(6),s=(n(13),n(0)),o=n(14),a=n(15),l=n(1),u={node:null,locked:0,createNode:function(t){if(t){var e,n=document.querySelector(t.ele);if(!n)throw new l("Template element not find, query by '"+t.ele+"'");return(t.ele=n).id&&(t.name=n.id),(e=t.template||n.innerHTML)?i(e).createInstance(t):(t.render=function(){return""},new r(t))}},init:function(t){if(!t)throw new Error("init FocusNode is empty");if(t instanceof r)this.node=t;else if("string"==typeof t){if(this.node=r.querySelecter(t),!this.node)return!1}else this.node=this.createNode(t);return this.node.dispatch("on"),!0},getNodeById:function(t){return r.querySelecter(t)},change:function(t,e){if(!(t instanceof r))return!1;if(this.node){if(e)if(this.node.dispatch("border",{dir:e,new_node:t}).defaultPrevented)return!1;this.node.dispatch("blur",{dir:e,new_node:t})}return this.node=t,this.node.dispatch("on",{dir:e}),!0},setting:function(t){t.debug&&(s.OpenDebug=t.debug),2==t.moveType&&(s.moveType=2),t.ui&&r.addDefaultEventListener("on",function(t){var e;this.children||(e=this.getPost(),o.on(this.width,this.height,e.left,e.top),u.locked=0)})},hideUI:function(t){o.hide()},addEventListener:function(t,e,n){if("object"==typeof e)for(var i in e)r.addEventListener(t,i,e[i]);else"function"==typeof n&&r.addEventListener(t,e,n)},moveTo:function(t){if(this.node&&!this.locked){var e=a.getNext(this.node,t);return e?this.change(e,t):(this.node.dispatch("border",{dir:t}),!1)}}};r.addDefaultEventListener("destroy",function(t){var e;this.id==u.node.id&&(e=u.node.id,setTimeout(function(){if(u.node=r.querySelecter(e),!u.node)throw new Error("current FocusNode has been deleted, id:"+e)},0))}),t.exports=u},function(t,e,n){var s=n(7),o=n(8);t.exports=function(t){var e=new o,n=new s(t),i=e.exec(t);for(var r in i[1])n.addRender(new Function("$Runtime","return "+i[1][r])(n),r);return n.addRender(new Function("$Runtime","return "+i[0])(n)),console.log(i),n}},function(t,e,n){var i=n(3),r=n(1);function s(t){this.template=t,this.subComps={},this.subTemps={},this.listener={},this.name="root",this.render=function(){return""}}s.prototype.createInstance=function(t){return t.render=this.render,t.name=this.name,new i(t)},s.prototype.createNode=function(t,e){return this.subComps[e]?this.subComps[e].createInstance(t):this.subTemps[e]?(t.render=this.subTemps[e],t.name=e,new i(t)):null},s.prototype.addRender=function(t,e){e?this.subTemps[e]=t:this.render=t},s.prototype.addSubcomponent=function(t){this.subComps[t.name]=t},s.prototype.addListener=function(t,e){i.addEventListener(this.name,t,e)},s.prototype.forEach=function(t,e,n){if(!0!==e&&(n=e,e=!1),t instanceof Array)for(var i=0,r=t.length;i<r;i++)n(t[i],i);else{if(e)throw new TypeError("The each attribute of the Focus must be an array");for(var i in t)n(t[i],i)}},s.prototype.error=function(t,e,n){return r(t,this.template.substr(e,n-e),r.ERROR_RUN)},t.exports=s},function(t,e,n){var l=n(9),u=n(10),i=n(11),h=n(1);function r(){this.space=new i,this.pointer=this.space}r.prototype.exec=function(t){for(var e,n=new RegExp(l.Catcher,"ig"),i=n.exec(t),r=0,s=t.length;null!==i;){if(r<i.index&&l.parseString(t.substr(r,i.index-r),this.pointer),undefined!==i[1])e=l.parseStatement(i[1],this.pointer);else if(undefined!==i[2])try{e=l.parseFocus(i[0],i[2],this.pointer)}catch(a){throw h(a,t.substr(i.index),h.ERROR_COMPILE)}else e={};e.subspace?(this.pointer=e.subspace,this.pointer.start=i.index):"closeEach"!=e.name&&"closeFocus"!=e.name&&"closeIf"!=e.name||(this.pointer.end=n.lastIndex-1,"closeFocus"==e.name&&"FocusEach"==this.pointer.parent.type&&(this.pointer.parent.end=this.pointer.end,this.pointer.parent.start=this.pointer.start,this.pointer=this.pointer.parent,this.pointer.addToken("Statement","closeEach")),this.pointer=this.pointer.parent),r=n.lastIndex,i=n.exec(t)}if(r!=s&&l.parseString(t.substr(r,s-r),this.pointer),null===this.pointer.parent)return this.pointer.end=s-1,u.build(this.space);var o="",o="Focus"==this.pointer.type?"<"+this.pointer.type+">":"{{"+this.pointer.type+"}}";throw h(o+" tag is not closed",t.substr(this.pointer.start),h.ERROR_COMPILE)},t.exports=r},function(t,e){var n={Catcher:"(?:{{\\s*(.+?)\\s*}})|(?:</?\\s*focus\\s*([\\w\\W]*?)>)|(?:\x3c!--[\\s\\S]*?--\x3e)",parseString:function(t,e){return e.addToken("String","string",t)},parseStatement:function(t,e){return"/if"==t?e.addToken("Statement","closeIf"):"/each"==t?e.addToken("Statement","closeEach"):"if "==t.substr(0,3)?e.addToken("Statement","if",t.substr(3,t.length-1)):"else"==t.substr(0,4)?e.addToken("Statement","else"):"else if "==t.substr(0,8)?e.addToken("Statement","elseIf",t.substr(8,t.length-1)):"each "==t.substr(0,5)?e.addToken("Statement","each",t.substr(5,t.length-1)):e.addToken("Expression","expression",t)},parseFocus:function(t,e,n){if("</"==t.substr(0,2))return n.addToken("Focus","closeFocus");for(var i,r,s=/([a-zA-Z\-_]+)(?:\s*=\s*(?:(?:"([\w\W]*?)")|(?:{{([\S ]+?)}})))?/g,o=s.exec(e),a={},l="";null!=o;)"each"==(i=o[1])?l=o[3]||o[2].replace(/{{|}}/g,""):o[3]?a[i]={type:"Variable",value:o[3]}:(r=/^{{([\S ]+?)}}$/.exec(o[2]),a[i]=null!==r?{type:"Variable",value:r[1]}:"data"==i||"each"==i?{type:"Variable",value:o[2]}:{type:"String",value:o[2]}),o=s.exec(e);if(undefined==a.name&&undefined!=a["class"]&&"String"==a["class"].type&&(a.name={type:"String",value:a["class"].value.replace(/ +/g,"_")}),undefined===a.name)throw new Error("focus tag need 'name' attribute");if("String"!==a.name.type)throw new Error("'name' attribute must be a string");if(a.layout&&"Variable"===a.layout.type)throw new Error("'layout' attribute value cannot be a variable");if(a.scroll){if("Variable"===a.scroll.type)throw new Error("'scroll' attribute value cannot be a variable");if(a.scroll.value||(a.scroll.dir="x",a.scroll.value=0),!(o=/^(x|y|auto)(?::(?:(-?\d+)|(?:{{\s*(.+?)\s*}})))?$/.exec(a.scroll.value)))throw new Error("'scroll' attribute value error");a.scroll.dir=o[1],undefined!==o[3]?(a.scroll.type="Variable",a.scroll.value=o[3]):a.scroll.value=o[2]||0}return undefined==a.data&&(a.data=l?{type:"Variable",value:"$value"}:{type:"Variable",value:a.name.value}),l?n.addToken("Statement","focusEach",l).subspace.addToken("Focus","focus",a):n.addToken("Focus","focus",a)}};t.exports=n},function(t,e,n){var d=n(0),f=n(4),y="$out";function g(t,e,n){return"String"==n?t+":'"+e+"'":t+":"+e}function v(t,e,n){return"String"==n?t+'="'+e+'"':t+"=\"'+"+e+"+'\""}function b(t){var e,n=[];for(var i in t)e=t[i],"cssTextV"==i?n.push("'"+e.value+"'"):"String"==e.type?n.push(i+":"+e.value+(e.unit||"")):n.push(i+":'+("+e.value+"||0)+'"+(e.unit||""));return n.join(";")}function i(t){this.context=t,this.$CHILD_FUNCS={}}i.prototype.build=function(t){var e,n,i=(t=t||this.context).tokens.length,r="";"Each"===t.type||"FocusEach"===t.type?r="function("+t.variables.join(",")+"){\ntry {":"Focus"===t.type&&(r="function($data){\nvar $out='';\nvar _thisnode=this;\ntry {");for(var s=0;s<i;s++)switch((e=t.tokens[s]).type){case"String":r+=this.outputString(e.code);break;case"Statement":r+=this.outputStatement(e);break;case"Expression":r+=this.outputExpression(e.code);break;case"Focus":"closeFocus"==e.name?r+="":r+=this.outputFocus(e)}return n="\n}catch (e) {throw $Runtime.error(e, "+t.start+", "+t.end+")}","If"===t.type?r+="}":"Focus"===t.type?r+=n+"\nreturn "+y+";\n}":"Each"!==t.type&&"FocusEach"!==t.type||(r+=n+"});"),r},i.prototype.outputString=function(t){var e=[];return t.split(/\r\n|\n/).forEach(function(t){0<t.length&&e.push(y+" += '"+t.replace(/'/g,"\\'")+"';")}),"\n"+e.join("\n")},i.prototype.outputStatement=function(t){return t.subspace?"\n"+t.code+this.build(t.subspace):"\n"+t.code},i.prototype.outputExpression=function(t){return"\n$out += "+t+";"},i.prototype.outputFocus=function(t){var e,n,i,r=t.subspace,s=[],o=[],a=[],l=[],u=[],h=r.attributes.name.value;for(var c in r.attributes)if(e=r.attributes[c],"name"==c||"id"==c)a.push(g(c,e.value,e.type));else if("data"==c)a.push(g(c,e.value));else if("cache"==c)h&&(_cache_key=f()),a.push("cache:'"+_cache_key+"'");else if("scroll"==c)"y"==e.dir?(i=[0,e.value],a.push("scrollY:"+e.value)):"x"==e.dir?(i=[e.value,0],a.push("scrollX:"+e.value)):i=[0];else if("layout"==c){if(undefined!==e.value)for(var p in e.value)l.push(g(p,e.value[p].value,"Variable"))}else"disabled"==c?"false"===e.value?a.push("disabled:false"):"Variable"==e.type?a.push("disabled:"+e.value):a.push("disabled:true"):"style"!=c&&("data-"==c.substr(0,5)?u.push(g(c.substr(5),e.value,e.type)):o.push(v(c,e.value,e.type)));return n=r.attributes.style,0<l.length&&a.push("layout:{"+l.join(",")+"}"),0<u.length&&a.push("ext_data:{"+u.join(",")+"}"),this.$CHILD_FUNCS[h]=this.build(r),s.push("\nvar _f=$Runtime.createNode({"+a.join(",")+"},'"+h+"');\n_thisnode.addChild(_f);"),undefined!==i?(n.value.position={type:"String",value:"relative"},n.value.overflow={type:"String",value:"hidden"},o.push(v("style",b(n.value),"String")),s.push(y+" += '<div "+o.join(" ")+" id=\"'+_f.fingerprint+'\">';"),1==i.length&&s.push("if (undefined !== _f.scrollX || undefined !== _f.scrollY) {"),s.push(y+" += '<div style=\"position:absolute;width:inherit;"+d.buildPostStypeString(i[0],i[1])+"\">';"),s.push(y+" += _f.render();"),s.push(y+" += '</div>'"),1==i.length&&(s.push("} else {"),s.push(y+" += _f.render();"),s.push("}"))):((n=b(n.value))&&o.push(v("style",n,"String")),s.push(y+" += '<div "+o.join(" ")+" id=\"'+_f.fingerprint+'\">';"),s.push(y+" += _f.render();")),s.push(y+" += '</div>'"),s.join("\n")+";"},t.exports={build:function(t){var e=new i(t);return[e.build(),e.$CHILD_FUNCS]}}},function(t,e,n){var a=n(12);function l(t,e){this.parent=t||null,this.tokens=[],this.type=e||"Focus",this.variables=[],this.attributes=[],this.start=0,this.end=0}l.prototype.setAttributes=function(t){this.attributes=t},l.prototype.setVariables=function(t){this.variables=t},l.prototype.addVariable=function(t){this.variables.push(t)},l.prototype.addToken=function(t,e,n){n=n||"";var i,r,s,o=new a(t,e);return this.tokens.push(o),o.addSpace(this),"if"==o.name?(s=new l(this,"If"),o.addSubspace(s)):"each"==o.name?(i=n.split(/[ \t]+/),s=new l(this,"Each"),""==i[0]&&i.shift(),r=i.length,n=i[0],r<2&&(i[1]="$value"),r<3&&(i[2]="$index"),s.addVariable(i[1]),s.addVariable(i[2]),o.addSubspace(s)):"focusEach"==o.name?((s=new l(this,"FocusEach")).addVariable("$value"),s.addVariable("$index"),o.addSubspace(s)):"focus"==o.name&&((s=new l(this,"Focus")).setAttributes(o.parseFocus(n)),o.addSubspace(s)),o.parse(n),o},t.exports=l},function(t,e){function n(t,e){this.type=t,this.name=e,this.code="",this.space=null,this.subspace=null}n.prototype.addSpace=function(t){this.space=t},n.prototype.addSubspace=function(t){this.subspace=t},n.prototype.parse=function(t){switch(this.name){case"closeIf":case"closeEach":case"closeFocus":case"focus":this.code="";break;case"else":this.code="}else {";break;case"string":this.code=t;break;case"each":this.code="$Runtime.forEach("+this._parseStr(t)+",";break;case"focusEach":this.code="$Runtime.forEach("+this._parseStr(t)+", true, ";break;case"if":this.code="if ("+this._parseStr(t)+") {";break;default:this.code=this._parseStr(t)}},n.prototype.parseFocus=function(t){var e,n,i,r=t.data.value;for(var s in t)"Variable"==(e=t[s]).type?(e.value=this._parseStr(e.value.replace(/\$self/g,r)),"style"==s&&(e.type="mixed",e.value={cssTextV:{value:e.value,type:"Variable"}})):"layout"==s?"def"==e.value||"default"==e.value?(e.type="mixed",e.value={}):"auto"!=e.value&&e.value?(e.type="mixed",e.value=this._parseStyle(e.value,r)):t[s]=undefined:"style"==s&&(e.type="mixed",e.value=this._parseStyle(e.value,r));return t.style||(t.style={type:"mixed",value:{}}),t.layout&&"mixed"==t.style.type&&(n=t.layout.value,i=t.style.value,undefined===n.width&&i.width&&"px"==i.width.unit&&(n.width=i.width),undefined===!n.height&&i.height&&"px"==i.height.unit&&(n.height=i.height)),t},n.prototype._parseStr=function(t){var e,n,i,r,s,o,a="",l=/[^\w\."']([a-zA-Z$_.]{1}[0-9a-zA-Z$_]*)/g,u=1;for(t=" "+t,r=l.exec(t),n=t.length,i=this.space.variables;null!==r;)o="",o="$data"==(s=r[1])||"."==s?"$data":-1<i.indexOf(s)||/\b(Array|Date|Object|String|new|Math|NaN|undefined|null|true|false|Number|JSON|instanceof|typeof)\b/.test(s)?s:"$data."+s,u<(e=r.index+1)&&(a+=t.substr(u,e-u)),u=l.lastIndex,a+=o,r=l.exec(t);return u!=n&&(a+=t.substr(u,n-u)),a||t},n.prototype._parseStyle=function(t,r){var s={},o=this;return t.split(";").forEach(function(t){var e,n,i=t.split(":");i[1]&&(n=/({{\s*(.+?)\s*}}|\d+)(px|%|em|rem)?/.exec(i[1]),e=i[0].trim(),null!==n?undefined!==n[2]?s[e]={type:"Variable",value:o._parseStr(n[2].replace(/\$self/g,r)),unit:n[3]||""}:s[e]={type:"String",value:n[1],unit:n[3]||""}:s[e]={type:"String",value:i[1],unit:""})}),s},t.exports=n},function(t,e){t.exports={DIR_UP:1,DIR_LEFT:2,DIR_DOWN:3,DIR_RIGHT:4}},function(t,e,n){var h,c,r=n(0),s=2,p={top:"0px",left:"0px",zIndex:"990",borderRadius:"6px",position:"absolute",backfaceVisibility:"hidden",border:"2px solid #b6f2ff",webkitTransitionProperty:"opacity",boxShadow:"#22c8de 0px 0px 22px 8px, #42e3f6 0px 0px 4px 1px inset"};function d(){if(h)for(var t in h.offsetHeight,p)h.style[t]=p[t];else{for(var t in h=document.createElement("div"),p)"className"==t?h.className=p.className:h.style[t]=p[t];document.body.appendChild(h)}p={}}function f(t,e,n,i){n-=s,i-=s,1===r.moveType?p.webkitTransform="translate3d("+n+"px,"+i+"px,0px)":(p.left=n+"px",p.top=i+"px"),p.opacity="1",p.width=t+"px",p.height=e+"px",d()}t.exports={on:function(t,e,n,i,r){var s,o,a,l,u;s=t,o=e,a=n,l=i,u=r,h&&(p.opacity="0",p.webkitTransitionDuration="0s",d()),c&&(clearTimeout(c),c=0),u?c=setTimeout(function(){c=0,f(s,o,a,l)},u):f(s,o,a,l)},hide:function(){c&&(clearTimeout(c),c=0),p.opacity="0",p.webkitTransitionDuration="0s",d()},setStyle:function(t){if("string"==typeof t){DefaultStyle.opacity="0",DefaultStyle.className=t,d();var e=getComputedStyle(h,null);s=parseInt(e.borderWidth)||0}else{for(var n in t)DefaultStyle[n]=t[n];t.border?s=parseInt(t.border):t.borderWidth&&(s=parseInt(t.borderWidth))}}}},function(t,e,n){var w=n(16),S=n(17),$=n(18);function E(t,e){if(!t.parent)return null;if("up"!=e&&"down"!=e&&"left"!=e&&"right"!=e)return null;for(var n,i,r,s,o,a,l,u,h,c,p,d=t.parent.children,f=[],y=null,g=d.length,v=0;v<g;v++)if(n=d[v],t.fingerprint!==n.fingerprint&&!n.disabled){var b=w[e](t,n);if(b){if(1===n.select){y=n;break}S[e](t.getRect(),n.getRect())?y=y?function m(t,e,n,i){var r=e.getRect(),s=n.getRect();return"up"==i?r.top+r.height<=s.top?n:s.top+s.height<=r.top?e:e.children||n.children?(e.children&&(e=$.mapOut(E($.mapIn(t,e),i))),n.children&&(n=$.mapOut(E($.mapIn(t,n),i))),m(t,e,n,i)):r.top+r.height>=s.top+s.height?e:n:"down"==i?s.top+s.height<=e.top?n:r.top+r.height<=s.top?e:e.children||n.children?(e.children&&(e=$.mapOut(E($.mapIn(t,e),i))),n.children&&(n=$.mapOut(E($.mapIn(t,n),i))),m(t,e,n,i)):r.top<=s.top?e:n:"left"==i?e.left+e.width<=s.left?n:s.left+s.width<=e.left?e:e.children||n.children?(e.children&&(e=$.mapOut(E($.mapIn(t,e),i))),n.children&&(n=$.mapOut(E($.mapIn(t,n),i))),m(t,e,n,i)):e.left+e.width>=s.left+s.width?e:n:s.left+s.width<=e.left?n:e.left+e.width<=s.left?e:e.children||n.children?(e.children&&(e=$.mapOut(E($.mapIn(t,e),i))),n.children&&(n=$.mapOut(E($.mapIn(t,n),i))),m(t,e,n,i)):e.left<=s.left?e:n}(t,y,n,e):n:n.children&&1!==b||f.push(n)}}if(!y&&0<f.length){g=f.length,(y=f[0]).children&&(y=$.mapOut(E($.mapIn(t,y),e)));for(var x=1;x<g;x++)(n=f[x]).children&&(n=$.mapOut(E($.mapIn(t,n),e))),i=y,r=n,p=c=h=u=l=a=o=s=void 0,s=t.getRect(),o=i.getRect(),a=r.getRect(),l={x:s.left+parseInt(s.width/2),y:s.top-parseInt(s.height/2)},u={x:o.left+parseInt(o.width/2),y:o.top-parseInt(o.height/2)},h={x:a.left+parseInt(a.width/2),y:a.top-parseInt(a.height/2)},y=(c={x:u.x-l.x,y:u.y-l.y}).x*c.x+c.y*c.y<=(p={x:h.x-l.x,y:h.y-l.y}).x*p.x+p.y*p.y?i:r}if(y){for(y.children&&(y=E($.mapIn(t,y),e));y.realnode;)y=y.realnode;return y}return"in"!=t.maping&&t.parent.parent?E($.mapOut(t),e):null}t.exports={getNext:E}},function(t,e){t.exports={up:function(t,e){return e.top+e.height<=t.top?1:e.top+e.height/2<t.top+t.height/2&&2},down:function(t,e){return t.top+t.height<=e.top?1:t.top+t.height/2<e.top+e.height/2&&2},left:function(t,e){return e.left+e.width<=t.left?1:e.left+e.width/2<t.left+t.width/2&&2},right:function(t,e){return t.left+t.width<=e.left?1:t.left+t.width/2<e.left+e.width/2&&2}}},function(t,e){function n(t,e){return!(e.left+e.width<t.left)&&(!(e.left>t.left+t.width)&&(e.left<=t.left&&e.left+e.width>=t.left+t.width||e.left>=t.left&&e.left+e.width<=t.left+t.width))}function i(t,e){return!(e.top+e.height<t.top)&&(!(e.top>t.top+t.height)&&(e.top<=t.top&&e.top+e.height>=t.top+t.height||e.top>=t.top&&e.top+e.height<=t.top+t.height))}t.exports={up:n,down:n,left:i,right:i}},function(t,e){function s(t,e,n,i){this.realnode=t,this.parent=e,this.width=t.width,this.height=t.height,this.top=n,this.left=i}s.prototype.getRect=function(){return{width:this.width,height:this.height,left:this.left,top:this.top}},t.exports={mapIn:function(t,e){var n=t.getRect(),i=e.getRect(),r=new s(t,e,n.top-i.top,n.left-i.left);return r.fingerprint=t.fingerprint,r.maping="in",r},mapOut:function(t){var e=t.getRect(),n=t.parent.getRect(),i=new s(t,t.parent.parent,e.top+n.top,e.left+n.left);return i.fingerprint=t.parent.fingerprint,i.maping="out",i}}}]);